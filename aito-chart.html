<link rel="import" href="bower_components/polymer/polymer.html">

<link rel="import" href="bower_components/google-chart/google-chart.html">

<dom-module id="aito-chart">
	<template>
		<google-chart type='area' options='{{options}}' cols='{{cols}}' rows='{{rows}}' hidden="{{!toShow}}">
		</google-chart>
		<h1>###<span>{{maxVal}}</span>###</h1>
	</template>

</dom-module>

<script>

Polymer({

    is: 'aito-chart',

    properties: {
    	item: Object,
		// data: Array,
		options: Array,
		cols: Array,
		rows: Array,
		maxVal: String,
		toShow: Boolean
			
		},
		
    ready: function() {
    	this.setProperties();
    	//console.log(this.maxVal);
    	//console.log(this.execRegExp());

	    },

    setProperties: function() {
    	if (this.item) {
    	var fbStat = [];
    	//console.log(typeof fbStat);
    	this.cols = [{label: "Time", type: "string"}, {label: "Likes", type: "number"}];
    	
    	
	    	var obj = this.item.stats[1];
	    	if (obj)
	    		obj = obj.history;
	    	else
	    		obj = {};

			var re = /..:..:../;
			for (var prop in obj) {
				var val = obj[prop];
	  			var p = re.exec(prop);
				p = p[0];
				//p = Date.parse(p);
				//console.log(p);
				var tempArray = [p, val];
				fbStat.push(tempArray);

				
			}
		

		//var maxVal = _.max(fbStat, function(arr){ return arr[1] });
    	//console.log(maxVal[1]);

    	this.options = {
			hAxis: {title: "Time", minValue: 0},
			//vAxis: {title: "Likes on " + this.item.stats[1].source, minValue: 0, maxValue: 100}
			vAxis: {title: "Likes on ", minValue: 0, maxValue: 100}
		};

		this.rows = _.sortBy(fbStat, function(arr) { return arr[0] });
		}
		
    },



});  

</script>
